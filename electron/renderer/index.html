<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; img-src 'self' data:;">
    <title>Kugutsu</title>
    <link rel="stylesheet" href="./styles/xterm.css">
    <link rel="stylesheet" href="./styles/main.css">
    <link rel="stylesheet" href="./styles/tasks.css">
</head>
<body>
    <div id="container">
        <div id="header">
            <h1>üöÄ Kugutsu</h1>
            <div id="status">
                <div class="status-item">
                    <div class="status-indicator" id="connection-status"></div>
                    <span>Connected</span>
                </div>
                <div class="status-item">
                    <span id="engineer-count">Engineers: 0</span>
                </div>
                <div class="status-item">
                    <span id="task-status">Tasks: 0/0</span>
                    <div class="progress-bar" id="task-progress-bar">
                        <div class="progress-bar-fill" id="task-progress-fill"></div>
                    </div>
                </div>
                <div class="pipeline-status">
                    <div class="pipeline-item">
                        <span class="pipeline-label">üìä ÈñãÁô∫:</span>
                        <span class="pipeline-value" id="pipeline-dev">ÂæÖÊ©ü=0, Âá¶ÁêÜ‰∏≠=0</span>
                    </div>
                    <div class="pipeline-item">
                        <span class="pipeline-label">üîç „É¨„Éì„É•„Éº:</span>
                        <span class="pipeline-value" id="pipeline-review">ÂæÖÊ©ü=0, Âá¶ÁêÜ‰∏≠=0</span>
                    </div>
                    <div class="pipeline-item">
                        <span class="pipeline-label">üîß „Éû„Éº„Ç∏:</span>
                        <span class="pipeline-value" id="pipeline-merge">ÂæÖÊ©ü=0, Âá¶ÁêÜ‰∏≠=0</span>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="main-content">
            <div class="tab-navigation">
                <div class="tab-group" id="main-tabs">
                    <button class="tab-btn active" data-tab="product-owner">üìä Product Owner</button>
                    <button class="tab-btn" data-tab="tasks">üìã Tasks</button>
                    <button class="tab-btn" data-tab="engineers">üë®‚Äçüíª Engineers & Tech Leads</button>
                    <button class="tab-btn" data-tab="merge">üîß Merge Coordinator</button>
                    <button class="tab-btn" data-tab="system">üìã System Logs</button>
                </div>
            </div>
            
            <div class="tab-panels">
                <!-- Product Owner Tab -->
                <div id="product-owner" class="tab-panel active">
                    <div class="terminal-pane product-owner full-height">
                        <div class="terminal-header">
                            <span class="terminal-title">üìä Product Owner AI</span>
                            <div class="terminal-actions">
                                <span class="terminal-action" data-terminal="product-owner">Clear</span>
                            </div>
                        </div>
                        <div class="terminal-container" id="product-owner-terminal"></div>
                    </div>
                </div>
                
                <!-- Tasks Tab -->
                <div id="tasks" class="tab-panel">
                    <div class="tasks-container">
                        <div class="tasks-overview">
                            <div class="overview-header">
                                <h2>üìã Project Overview</h2>
                                <button class="btn-small" id="refresh-tasks">üîÑ Refresh</button>
                            </div>
                            <div class="overview-content" id="overview-content">
                                <p>Loading project overview...</p>
                            </div>
                        </div>
                        <div class="tasks-list">
                            <div class="tasks-header">
                                <h2>üìù Task List</h2>
                                <div class="task-filters">
                                    <select id="task-filter-status">
                                        <option value="all">All Status</option>
                                        <option value="pending">Pending</option>
                                        <option value="in_progress">In Progress</option>
                                        <option value="completed">Completed</option>
                                        <option value="failed">Failed</option>
                                    </select>
                                    <select id="task-filter-type">
                                        <option value="all">All Types</option>
                                        <option value="feature">Feature</option>
                                        <option value="bugfix">Bugfix</option>
                                        <option value="refactor">Refactor</option>
                                        <option value="test">Test</option>
                                        <option value="docs">Docs</option>
                                    </select>
                                </div>
                            </div>
                            <div class="tasks-grid" id="tasks-grid">
                                <!-- „Çø„Çπ„ÇØ„Ç´„Éº„Éâ„ÅåÂãïÁöÑ„Å´ËøΩÂä†„Åï„Çå„Çã -->
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Engineers Tab -->
                <div id="engineers" class="tab-panel">
                    <div class="sub-tab-navigation">
                        <button class="scroll-btn left" id="engineer-scroll-left">‚óÄ</button>
                        <div class="sub-tabs-scroll">
                            <div class="sub-tabs" id="engineer-sub-tabs">
                                <!-- „Ç®„É≥„Ç∏„Éã„Ç¢„ÅÆ„Çµ„Éñ„Çø„Éñ„ÅåÂãïÁöÑ„Å´ËøΩÂä†„Åï„Çå„Çã -->
                            </div>
                        </div>
                        <button class="scroll-btn right" id="engineer-scroll-right">‚ñ∂</button>
                    </div>
                    <div class="sub-tab-content" id="engineer-panels">
                        <!-- „Ç®„É≥„Ç∏„Éã„Ç¢„ÅÆ„Çø„Éº„Éü„Éä„É´„Éë„Éç„É´„ÅåÂãïÁöÑ„Å´ËøΩÂä†„Åï„Çå„Çã -->
                    </div>
                </div>
                
                
                <!-- Merge Coordinator Tab -->
                <div id="merge" class="tab-panel">
                    <div class="terminal-pane merge-coordinator full-height">
                        <div class="terminal-header">
                            <span class="terminal-title">üîß Merge Coordinator</span>
                            <div class="terminal-actions">
                                <span class="terminal-action" data-terminal="merge-coordinator">Clear</span>
                            </div>
                        </div>
                        <div class="terminal-container" id="merge-coordinator-terminal"></div>
                    </div>
                </div>
                
                <!-- System Logs Tab -->
                <div id="system" class="tab-panel">
                    <div class="terminal-pane system full-height">
                        <div class="terminal-header">
                            <span class="terminal-title">üìã System Logs & Misc</span>
                            <div class="terminal-actions">
                                <span class="terminal-action" data-terminal="system">Clear</span>
                            </div>
                        </div>
                        <div class="terminal-container" id="system-terminal"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- „Çø„Çπ„ÇØË©≥Á¥∞„É¢„Éº„ÉÄ„É´ -->
    <div id="task-detail-modal" class="dialog-overlay">
        <div class="dialog-content task-detail">
            <div class="dialog-header">
                <h2 id="task-detail-title">Task Details</h2>
                <button class="dialog-close" id="close-task-detail">&times;</button>
            </div>
            <div class="dialog-body">
                <div class="task-instruction-content" id="task-instruction-content">
                    <pre>Loading task instructions...</pre>
                </div>
            </div>
        </div>
    </div>

    <!-- ÂÆå‰∫Ü„ÉÄ„Ç§„Ç¢„É≠„Ç∞ -->
    <div id="completion-dialog" class="dialog-overlay">
        <div class="dialog-content">
            <div class="dialog-header">
                <h2>üéâ All Tasks Completed! üéâ</h2>
            </div>
            <div class="dialog-body">
                <div class="completion-stats">
                    <div class="stat-item">
                        <span class="stat-label">Total Tasks:</span>
                        <span class="stat-value" id="total-tasks-count">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">‚úÖ Completed:</span>
                        <span class="stat-value success" id="completed-tasks-count">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">‚ùå Failed:</span>
                        <span class="stat-value error" id="failed-tasks-count">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">‚è±Ô∏è Total Time:</span>
                        <span class="stat-value" id="total-time">0s</span>
                    </div>
                </div>
                <div class="completion-message">
                    <p>All development tasks have been completed. You can now review the changes and proceed with the next steps.</p>
                </div>
            </div>
            <div class="dialog-footer">
                <button class="dialog-btn primary" id="view-summary-btn">üìä View Summary</button>
                <button class="dialog-btn secondary" id="create-pr-btn">üîÄ Create PR</button>
                <button class="dialog-btn" id="close-dialog-btn">Close</button>
            </div>
        </div>
    </div>

    <script type="module" src="./js/app.js"></script>
</body>
</html>